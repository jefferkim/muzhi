/* Zepto v1.0rc1 - polyfill zepto event detect fx ajax form touch - zeptojs.com/license */
function addEvent(e){e.addEventListener("touchend",ontouchend,!1),e.addEventListener("touchmove",ontouchmove,!1)}function removeEvent(e){e.removeEventListener("touchend",ontouchend,!1),e.removeEventListener("touchmove",ontouchmove,!1)}function ontouchstart(e){var t=this;addEvent(t)}function ontouchmove(e){var t=this;removeEvent(t)}function ontouchend(e){var t=this;t.className+=" c-linkfocus-active",setTimeout(function(){var e=t.className;t.className=e.replace(/c\-linkfocus\-active/g,""),removeEvent(t)},200)}function linkfocus(e){if(webkitTest.test(appVersion)&&androidTest.test(appVersion)){var t=document.styleSheets[0];t.addRule("*","-webkit-tap-highlight-color:rgba(0,0,0,0);"),e!==!1&&(t.addRule(".c-linkfocus","-webkit-mask:none;"),t.addRule(".c-linkfocus-move","-webkit-mask:none;"),t.addRule(".c-linkfocus-active",["background:transparent!important;","background-color:transparent!important;","-webkit-mask-clip: content-box;","-webkit-mask-origin: content;","-webkit-mask-repeat: no-repeat;","-webkit-border-radius: 3px;","-webkit-mask-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgba(0,0,0,0.3)), to(rgba(0,0,0,0.3)));"].join("")),typeof e=="string"?$(document).on("touchstart",e||'*[class~="c-linkfocus"]',ontouchstart):typeof e=="object"&&$(e).on("touchstart",ontouchstart))}}function ModePop(e){this._options=$.extend({mode:"msg",text:"网页提示",useTap:!1},e||{}),this._init()}function configS(){var e={},t="m";return window.location.host=="localhost"||window.location.host.match(".*\\waptest\\.(taobao|tmall|etao|alibaba|alipay|aliyun)\\.com.*")?t="waptest":window.location.host.match(".*\\wapa\\.(taobao|tmall|etao|alibaba|alipay|aliyun)\\.com.*")?t="wapa":window.location.host.match(".*\\m\\.(taobao|tmall|etao|alibaba|alipay|aliyun)\\.com.*")&&(t="m"),e.sysType=t||"m",e.indexPage="http://fav."+e.sysType+".taobao.com/h5proxy-midFav.htm",e.errorPage="http://fav."+e.sysType+".taobao.com/fav_error.htm",e}function h5_base(){function t(e){var t=Array.prototype.slice.call(arguments,1);for(var n=0,r=t.length;n<r;n++)for(var i in t[n])e[i]=t[n][i];return e}var e={};return e.paramKey="h5_paramKey",e.targetUrl="h5_targetUrl",e.userInfoKey="h5_userInfoKey",e.hrefHash="h5_hrefHashKey",e.appKey="h5_app_key",e.appToken="h5_app_token",e.appRefreshToken="h5_app_ref_token",e.appTokenExpired="h5_app_token_expired",e.appTokenBetween="h5_app_token_between",e.appTokenSaveTime="h5_app_token_save_time",e.appRequestFailed="h5_app_request_failed_tag",e.useLocalstorage=useLocalstorage=window.localStorage!=null,e.set=function(e,t){return useLocalstorage?(typeof t!="string"&&(t=JSON.stringify(t)),window.localStorage.setItem(e,t),!0):!1},e.add=function(e,n){if(useLocalstorage){if(typeof n=="string")n=JSON.parse(n);else{try{t(n,JSON.parse(getValue(e)))}catch(r){}n=JSON.stringify(n)}return window.localStorage.setItem(e,n),!0}return!1},e.get=getValue=function(e){return useLocalstorage?window.localStorage.getItem(e):null},e.removeValue=function(e){if(useLocalstorage)return window.localStorage.removeItem(e)},e.clearAll=function(){if(useLocalstorage)return window.localStorage.clear()},e.userCacheHash=function(){return!location.hash&&this.get(this.hrefHash)?(location.hash=this.get(this.hrefHash),!0):(location.hash&&this.set(this.hrefHash,location.hash),!1)},e.getParamFromStorage=function(e){try{return JSON.parse(this.get(this.paramKey))[e]}catch(t){}return null},e.getUserProFromStorage=function(e){try{return JSON.parse(this.get(this.userInfoKey))[e]}catch(t){}return null},e.getBetweenTime=function(e){return(new Date).getTime()-e},e.checkIsBlank=function(e){return null==e||""==e},e.isLogin=function(){var e=this.getUserProFromStorage("nick");return e==""||e==null?!1:!0},e.removeToken=function(){try{this.removeValue(this.appToken),this.removeValue(this.appRefreshToken),this.removeValue(this.appTokenExpired),this.removeValue(this.appTokenBetween),this.removeValue(this.appTokenSaveTime)}catch(e){}},e.getQueryString=function(e){var t=location.search;if(t.length<1)return"";t=t.substr(1);var n=t.split("&"),r={};for(i in n){var s=n[i].split("=");r[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e?r[e]:r},e}function h5_utils(){var e={};return e.isBlank=function(e){return e==null||typeof e=="undefined"||$.trim(e)==""?!0:!1},e.wrapColsure=function(e){return $.each(e,function(t){typeof e[t]=="function"&&(e[t]=_.bind(e[t],e))}),e},e.MD5=function(e){function t(e,t){return e<<t|e>>>32-t}function n(e,t){var n,r,i,s,o;return i=e&2147483648,s=t&2147483648,n=e&1073741824,r=t&1073741824,o=(e&1073741823)+(t&1073741823),n&r?o^2147483648^i^s:n|r?o&1073741824?o^3221225472^i^s:o^1073741824^i^s:o^i^s}function r(e,t,n){return e&t|~e&n}function i(e,t,n){return e&n|t&~n}function s(e,t,n){return e^t^n}function o(e,t,n){return t^(e|~n)}function u(e,i,s,o,u,a,f){return e=n(e,n(n(r(i,s,o),u),f)),n(t(e,a),i)}function a(e,r,s,o,u,a,f){return e=n(e,n(n(i(r,s,o),u),f)),n(t(e,a),r)}function f(e,r,i,o,u,a,f){return e=n(e,n(n(s(r,i,o),u),f)),n(t(e,a),r)}function l(e,r,i,s,u,a,f){return e=n(e,n(n(o(r,i,s),u),f)),n(t(e,a),r)}function c(e){var t,n=e.length,r=n+8,i=(r-r%64)/64,s=(i+1)*16,o=Array(s-1),u=0,a=0;while(a<n)t=(a-a%4)/4,u=a%4*8,o[t]=o[t]|e.charCodeAt(a)<<u,a++;return t=(a-a%4)/4,u=a%4*8,o[t]=o[t]|128<<u,o[s-2]=n<<3,o[s-1]=n>>>29,o}function h(e){var t="",n="",r,i;for(i=0;i<=3;i++)r=e>>>i*8&255,n="0"+r.toString(16),t+=n.substr(n.length-2,2);return t}function p(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t}var d=Array(),v,m,g,y,b,w,E,S,x,T=7,N=12,C=17,k=22,L=5,A=9,O=14,M=20,_=4,D=11,P=16,H=23,B=6,j=10,F=15,I=21;e=p(e),d=c(e),w=1732584193,E=4023233417,S=2562383102,x=271733878;for(v=0;v<d.length;v+=16)m=w,g=E,y=S,b=x,w=u(w,E,S,x,d[v+0],T,3614090360),x=u(x,w,E,S,d[v+1],N,3905402710),S=u(S,x,w,E,d[v+2],C,606105819),E=u(E,S,x,w,d[v+3],k,3250441966),w=u(w,E,S,x,d[v+4],T,4118548399),x=u(x,w,E,S,d[v+5],N,1200080426),S=u(S,x,w,E,d[v+6],C,2821735955),E=u(E,S,x,w,d[v+7],k,4249261313),w=u(w,E,S,x,d[v+8],T,1770035416),x=u(x,w,E,S,d[v+9],N,2336552879),S=u(S,x,w,E,d[v+10],C,4294925233),E=u(E,S,x,w,d[v+11],k,2304563134),w=u(w,E,S,x,d[v+12],T,1804603682),x=u(x,w,E,S,d[v+13],N,4254626195),S=u(S,x,w,E,d[v+14],C,2792965006),E=u(E,S,x,w,d[v+15],k,1236535329),w=a(w,E,S,x,d[v+1],L,4129170786),x=a(x,w,E,S,d[v+6],A,3225465664),S=a(S,x,w,E,d[v+11],O,643717713),E=a(E,S,x,w,d[v+0],M,3921069994),w=a(w,E,S,x,d[v+5],L,3593408605),x=a(x,w,E,S,d[v+10],A,38016083),S=a(S,x,w,E,d[v+15],O,3634488961),E=a(E,S,x,w,d[v+4],M,3889429448),w=a(w,E,S,x,d[v+9],L,568446438),x=a(x,w,E,S,d[v+14],A,3275163606),S=a(S,x,w,E,d[v+3],O,4107603335),E=a(E,S,x,w,d[v+8],M,1163531501),w=a(w,E,S,x,d[v+13],L,2850285829),x=a(x,w,E,S,d[v+2],A,4243563512),S=a(S,x,w,E,d[v+7],O,1735328473),E=a(E,S,x,w,d[v+12],M,2368359562),w=f(w,E,S,x,d[v+5],_,4294588738),x=f(x,w,E,S,d[v+8],D,2272392833),S=f(S,x,w,E,d[v+11],P,1839030562),E=f(E,S,x,w,d[v+14],H,4259657740),w=f(w,E,S,x,d[v+1],_,2763975236),x=f(x,w,E,S,d[v+4],D,1272893353),S=f(S,x,w,E,d[v+7],P,4139469664),E=f(E,S,x,w,d[v+10],H,3200236656),w=f(w,E,S,x,d[v+13],_,681279174),x=f(x,w,E,S,d[v+0],D,3936430074),S=f(S,x,w,E,d[v+3],P,3572445317),E=f(E,S,x,w,d[v+6],H,76029189),w=f(w,E,S,x,d[v+9],_,3654602809),x=f(x,w,E,S,d[v+12],D,3873151461),S=f(S,x,w,E,d[v+15],P,530742520),E=f(E,S,x,w,d[v+2],H,3299628645),w=l(w,E,S,x,d[v+0],B,4096336452),x=l(x,w,E,S,d[v+7],j,1126891415),S=l(S,x,w,E,d[v+14],F,2878612391),E=l(E,S,x,w,d[v+5],I,4237533241),w=l(w,E,S,x,d[v+12],B,1700485571),x=l(x,w,E,S,d[v+3],j,2399980690),S=l(S,x,w,E,d[v+10],F,4293915773),E=l(E,S,x,w,d[v+1],I,2240044497),w=l(w,E,S,x,d[v+8],B,1873313359),x=l(x,w,E,S,d[v+15],j,4264355552),S=l(S,x,w,E,d[v+6],F,2734768916),E=l(E,S,x,w,d[v+13],I,1309151649),w=l(w,E,S,x,d[v+4],B,4149444226),x=l(x,w,E,S,d[v+11],j,3174756917),S=l(S,x,w,E,d[v+2],F,718787259),E=l(E,S,x,w,d[v+9],I,3951481745),w=n(w,m),E=n(E,g),S=n(S,y),x=n(x,b);var q=h(w)+h(E)+h(S)+h(x);return q.toLowerCase()},e}function uri_link(){function f(t){if(null!=e.ttQueryStr&&""!=e.ttQueryStr){var n=t.match("\\.[a-zA-Z]+\\?");null!=n&&0<n.length?t.indexOf("?")==t.length-1?t+=e.ttQueryStr:t=t+"&"+e.ttQueryStr:t=t+"?"+e.ttQueryStr}return t}function l(e,t,n,r){h(r)||(e+="/"+r),h(t)||(e+="/"+t);var i=!1;if(null!=n)for(var s in n)if(null!=n[s]){i=!0;break}return i&&(e+="?"+d(n)),e}function c(e){if(h(e))return!1;for(var t=0;t<r.length;t++)if(r[t].toLowerCase()==e.toLowerCase())return!0;return!1}function h(e){return n.checkIsBlank(e)}function p(t,n){return t.replace(i,function(){return c(n)?n:e.uri.defaultDomain})}function d(e){var t="";if(null==e)return t;for(var n in e)null!=e[n]&&""!=e[n]&&(t+=n+"="+encodeURIComponent(e[n])+"&");return""!=t&&t.length-1==t.lastIndexOf("&")&&(t=t.substr(0,t.length-1)),t}var e={},t=configS(),n=h5_base();e.uri={protocol:"http://",sysType:t.sysType||"m",defaultDomain:"taobao"};var r=["taobao","tmall","etao","alibaba","alipay"],i="${_serverDomain}";e._serverHost=e.uri.sysType+"."+i+".com",e.subUri={index:e.uri.protocol+e._serverHost},e.ttQueryStr="";try{var s=JSON.parse(n.get(n.userInfoKey)||"{}")||{},o=s.sid;null!=o&&""!=o&&(e.ttQueryStr+="sid="+o);var u=JSON.parse(n.get(n.paramKey)||"{}")||{};u.ttid&&""!=u.ttid&&(e.ttQueryStr+="&ttid="+u.ttid)}catch(a){}return e.renderURI=function(e,t,n,r,i){return f(l(p(e,i),t,n,r))},e.renderDomain=function(t,n,r,i){return f(l(p(e.subUri.index,i),t,n,r))},e.renderServer=function(e,t,n,r){return f(l(r,e,t,n))},e.encode=function(e){return encodeURI(e)},e.getStrParamFromJson=function(e){return d(e)},e.createURI=function(t){return t==="home"?e.uri.protocol+e._serverHost:e.uri.protocol+t+"."+e._serverHost},e}function mtop_h5(){var e={},t=h5_base(),n=h5_utils(),r=uri_link(),i="J_app_key",s="h5Api.do";e.getFirstToken=function(e,t,n){var o={};o.api="mtop.auth.h5.getFirstToken2",o.v=e||"1.0",o.appKey=document.getElementById(i).value,o.t=(new Date).getTime();var u=f(r.renderURI(r.createURI("api"),s,o,"rest"));$.ajax({type:"GET",url:u,timeout:1e4,success:function(e){var n=(e.ret?e.ret:"").toString();-1!=n.indexOf("SUCCESS::")&&c(e),t&&t(e)},error:function(e){n&&n(e)},complete:function(e,t){t!="success"&&n&&n(t)}})},e.getApi=function(n,a,f,l,c,h){l.api=n,l.v=a||"*",l.data=typeof f=="string"?f:JSON.stringify(f);var p=r.renderURI(r.createURI("api"),s,l,"rest"),d=document.getElementById(i).value;o()?e.getFirstToken("1.0",function(e){var t=(e.ret?e.ret:"").toString();-1!=t.indexOf("SUCCESS::")?u(p,d,e.data.token.token,l.data,c,h):c&&c(e)},function(e){h&&h(e)}):u(p,d,t.get(t.appToken),l.data,c,h)};var o=function(){var e=t.get(t.appToken);if(t.checkIsBlank(e))return!0;var n=parseInt(t.get(t.appTokenExpired)||"0"),r=parseInt(t.get(t.appTokenBetween)||"0"),i=parseInt(t.get(t.appTokenSaveTime)||"0"),s=(new Date).getTime();return s-i>6e4||n-s+r<6e4?!0:!1},u=function(e,n,r,i,s,o){e=a(e,n,r,i),$.ajax({type:"GET",url:e,timeout:1e4,success:function(e){var n=(e.ret?e.ret:"").toString();-1==n.indexOf("SUCCESS")&&t.removeToken(),s&&s(e)},error:function(e){o&&o(e)},complete:function(e,t){t!="success"&&o&&o(t)}})},a=function(e,t,n,r){var i=(new Date).getTime();return f(e)+"&appKey="+t+"&sign="+l(t,n,i,r)+"&t="+i},f=function(e){if(-1==e.indexOf("callback=")){var t=e.indexOf("?");return e.substr(0,t)+"?callback=?&type=jsonp&"+e.substr(t+1,e.length)}return e},l=function(e,t,r,i){var s=t+"&"+r+"&"+e+"&"+i;return n.MD5(s)},c=function(e){var n=e.data.token.token,r=parseInt(e.data.token.createTime||"0")+parseInt(e.data.token.lifetime||"0")*1e3,i=parseInt(e.data.token.createTime||"0"),s=e.data.token.refreshToken,o=(new Date).getTime(),u=t.getBetweenTime(i);if(!(!t.checkIsBlank(n)&&r>o-u))return null;try{t.set(t.appToken,n),t.set(t.appTokenExpired,r),t.set(t.appTokenBetween,u),t.set(t.appTokenSaveTime,o);if(t.get(t.appToken)==n)return n}catch(a){return null}};return e}function _checkSysType(){var e="m";return window.location.host=="localhost"||window.location.host.match(".*\\waptest\\.(taobao|tmall|etao|alibaba|alipay|aliyun)\\.com.*")?e="waptest":window.location.host.match(".*\\wapa\\.(taobao|tmall|etao|alibaba|alipay|aliyun)\\.com.*")?e="wapa":window.location.host.match(".*\\m\\.(taobao|tmall|etao|alibaba|alipay|aliyun)\\.com.*")&&(e="m"),e}(function(e){String.prototype.trim===e&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),Array.prototype.reduce===e&&(Array.prototype.reduce=function(t){if(this===void 0||this===null)throw new TypeError;var n=Object(this),r=n.length>>>0,i=0,s;if(typeof t!="function")throw new TypeError;if(r==0&&arguments.length==1)throw new TypeError;if(arguments.length>=2)s=arguments[1];else do{if(i in n){s=n[i++];break}if(++i>=r)throw new TypeError}while(!0);while(i<r)i in n&&(s=t.call(e,s,n[i],i,n)),i++;return s})})();var Zepto=function(){function e(e){return B.call(e)=="[object Function]"}function t(e){return e instanceof Object}function n(t){var n,r;if(B.call(t)!=="[object Object]")return!1;r=e(t.constructor)&&t.constructor.prototype;if(!r||!hasOwnProperty.call(r,"isPrototypeOf"))return!1;for(n in t);return n===v||hasOwnProperty.call(t,n)}function r(e){return e instanceof Array}function i(e){return typeof e.length=="number"}function s(e){return e.filter(function(e){return e!==v&&e!==null})}function o(e){return e.length>0?[].concat.apply([],e):e}function u(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function a(e){return e in x?x[e]:x[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function f(e,t){return typeof t=="number"&&!N[u(e)]?t+"px":t}function l(e){var t,n;return S[e]||(t=E.createElement(e),E.body.appendChild(t),n=T(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),n=="none"&&(n="block"),S[e]=n),S[e]}function c(e,t){return t===v?g(e):g(e).filter(t)}function h(t,n,r,i){return e(n)?n.call(t,r,i):n}function p(e,t,n){var r=e%2?t:t.parentNode;r?r.insertBefore(n,e?e==1?r.firstChild:e==2?t:null:t.nextSibling):g(n).remove()}function d(e,t){t(e);for(var n in e.childNodes)d(e.childNodes[n],t)}var v,m,g,y,b=[],w=b.slice,E=window.document,S={},x={},T=E.defaultView.getComputedStyle,N={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},C=/^\s*<(\w+|!)[^>]*>/,k=[1,3,8,9,11],L=["after","prepend","before","append"],A=E.createElement("table"),O=E.createElement("tr"),M={tr:E.createElement("tbody"),tbody:A,thead:A,tfoot:A,td:O,th:O,"*":E.createElement("div")},_=/complete|loaded|interactive/,D=/^\.([\w-]+)$/,P=/^#([\w-]+)$/,H=/^[\w-]+$/,B={}.toString,j={},F,I,q=E.createElement("div");return j.matches=function(e,t){if(!e||e.nodeType!==1)return!1;var n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var r,i=e.parentNode,s=!i;return s&&(i=q).appendChild(e),r=~j.qsa(i,t).indexOf(e),s&&q.removeChild(e),r},F=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},I=function(e){return e.filter(function(t,n){return e.indexOf(t)==n})},j.fragment=function(e,t){t===v&&(t=C.test(e)&&RegExp.$1),t in M||(t="*");var n=M[t];return n.innerHTML=""+e,g.each(w.call(n.childNodes),function(){n.removeChild(this)})},j.Z=function(e,t){return e=e||[],e.__proto__=arguments.callee.prototype,e.selector=t||"",e},j.isZ=function(e){return e instanceof j.Z},j.init=function(t,i){if(!t)return j.Z();if(e(t))return g(E).ready(t);if(j.isZ(t))return t;var o;if(r(t))o=s(t);else if(n(t))o=[g.extend({},t)],t=null;else if(k.indexOf(t.nodeType)>=0||t===window)o=[t],t=null;else if(C.test(t))o=j.fragment(t.trim(),RegExp.$1),t=null;else{if(i!==v)return g(i).find(t);o=j.qsa(E,t)}return j.Z(o,t)},g=function(e,t){return j.init(e,t)},g.extend=function(e){return w.call(arguments,1).forEach(function(t){for(m in t)t[m]!==v&&(e[m]=t[m])}),e},j.qsa=function(e,t){var n;return e===E&&P.test(t)?(n=e.getElementById(RegExp.$1))?[n]:b:e.nodeType!==1&&e.nodeType!==9?b:w.call(D.test(t)?e.getElementsByClassName(RegExp.$1):H.test(t)?e.getElementsByTagName(t):e.querySelectorAll(t))},g.isFunction=e,g.isObject=t,g.isArray=r,g.isPlainObject=n,g.inArray=function(e,t,n){return b.indexOf.call(t,e,n)},g.trim=function(e){return e.trim()},g.uuid=0,g.map=function(e,t){var n,r=[],s,u;if(i(e))for(s=0;s<e.length;s++)n=t(e[s],s),n!=null&&r.push(n);else for(u in e)n=t(e[u],u),n!=null&&r.push(n);return o(r)},g.each=function(e,t){var n,r;if(i(e)){for(n=0;n<e.length;n++)if(t.call(e[n],n,e[n])===!1)return e}else for(r in e)if(t.call(e[r],r,e[r])===!1)return e;return e},g.fn={forEach:b.forEach,reduce:b.reduce,push:b.push,indexOf:b.indexOf,concat:b.concat,map:function(e){return g.map(this,function(t,n){return e.call(t,n,t)})},slice:function(){return g(w.apply(this,arguments))},ready:function(e){return _.test(E.readyState)?e(g):E.addEventListener("DOMContentLoaded",function(){e(g)},!1),this},get:function(e){return e===v?w.call(this):this[e]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(e){return this.forEach(function(t,n){e.call(t,n,t)}),this},filter:function(e){return g([].filter.call(this,function(t){return j.matches(t,e)}))},add:function(e,t){return g(I(this.concat(g(e,t))))},is:function(e){return this.length>0&&j.matches(this[0],e)},not:function(t){var n=[];if(e(t)&&t.call!==v)this.each(function(e){t.call(this,e)||n.push(this)});else{var r=typeof t=="string"?this.filter(t):i(t)&&e(t.item)?w.call(t):g(t);this.forEach(function(e){r.indexOf(e)<0&&n.push(e)})}return g(n)},eq:function(e){return e===-1?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!t(e)?e:g(e)},last:function(){var e=this[this.length-1];return e&&!t(e)?e:g(e)},find:function(e){var t;return this.length==1?t=j.qsa(this[0],e):t=this.map(function(){return j.qsa(this,e)}),g(t)},closest:function(e,t){var n=this[0];while(n&&!j.matches(n,e))n=n!==t&&n!==E&&n.parentNode;return g(n)},parents:function(e){var t=[],n=this;while(n.length>0)n=g.map(n,function(e){if((e=e.parentNode)&&e!==E&&t.indexOf(e)<0)return t.push(e),e});return c(t,e)},parent:function(e){return c(I(this.pluck("parentNode")),e)},children:function(e){return c(this.map(function(){return w.call(this.children)}),e)},siblings:function(e){return c(this.map(function(e,t){return w.call(t.parentNode.children).filter(function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return this.map(function(){return this[e]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=null),T(this,"").getPropertyValue("display")=="none"&&(this.style.display=l(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return this.each(function(){g(this).wrapAll(g(e)[0].cloneNode(!1))})},wrapAll:function(e){return this[0]&&(g(this[0]).before(e=g(e)),e.append(this)),this},unwrap:function(){return this.parent().each(function(){g(this).replaceWith(g(this).children())}),this},clone:function(){return g(this.map(function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(e){return(e===v?this.css("display")=="none":e)?this.show():this.hide()},prev:function(){return g(this.pluck("previousElementSibling"))},next:function(){return g(this.pluck("nextElementSibling"))},html:function(e){return e===v?this.length>0?this[0].innerHTML:null:this.each(function(t){var n=this.innerHTML;g(this).empty().append(h(this,e,t,n))})},text:function(e){return e===v?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=e})},attr:function(e,n){var r;return typeof e=="string"&&n===v?this.length==0||this[0].nodeType!==1?v:e=="value"&&this[0].nodeName=="INPUT"?this.val():!(r=this[0].getAttribute(e))&&e in this[0]?this[0][e]:r:this.each(function(r){if(this.nodeType!==1)return;if(t(e))for(m in e)this.setAttribute(m,e[m]);else this.setAttribute(e,h(this,n,r,this.getAttribute(e)))})},removeAttr:function(e){return this.each(function(){this.nodeType===1&&this.removeAttribute(e)})},prop:function(e,t){return t===v?this[0]?this[0][e]:v:this.each(function(n){this[e]=h(this,t,n,this[e])})},data:function(e,t){var n=this.attr("data-"+u(e),t);return n!==null?n:v},val:function(e){return e===v?this.length>0?this[0].value:v:this.each(function(t){this.value=h(this,e,t,this.value)})},offset:function(){if(this.length==0)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:e.width,height:e.height}},css:function(e,t){if(t===v&&typeof e=="string")return this.length==0?v:this[0].style[F(e)]||T(this[0],"").getPropertyValue(e);var n="";for(m in e)typeof e[m]=="string"&&e[m]==""?this.each(function(){this.style.removeProperty(u(m))}):n+=u(m)+":"+f(m,e[m])+";";return typeof e=="string"&&(t==""?this.each(function(){this.style.removeProperty(u(e))}):n=u(e)+":"+f(e,t)),this.each(function(){this.style.cssText+=";"+n})},index:function(e){return e?this.indexOf(g(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return this.length<1?!1:a(e).test(this[0].className)},addClass:function(e){return this.each(function(t){y=[];var n=this.className,r=h(this,e,t,n);r.split(/\s+/g).forEach(function(e){g(this).hasClass(e)||y.push(e)},this),y.length&&(this.className+=(n?" ":"")+y.join(" "))})},removeClass:function(e){return this.each(function(t){if(e===v)return this.className="";y=this.className,h(this,e,t,y).split(/\s+/g).forEach(function(e){y=y.replace(a(e)," ")}),this.className=y.trim()})},toggleClass:function(e,t){return this.each(function(n){var r=h(this,e,n,this.className);(t===v?!g(this).hasClass(r):t)?g(this).addClass(r):g(this).removeClass(r)})}},["width","height"].forEach(function(e){g.fn[e]=function(t){var n,r=e.replace(/./,function(e){return e[0].toUpperCase()});return t===v?this[0]==window?window["inner"+r]:this[0]==E?E.documentElement["offset"+r]:(n=this.offset())&&n[e]:this.each(function(n){var r=g(this);r.css(e,h(this,t,n,r[e]()))})}}),L.forEach(function(e,n){g.fn[e]=function(){var e=g.map(arguments,function(e){return t(e)?e:j.fragment(e)});if(e.length<1)return this;var r=this.length,i=r>1,s=n<2;return this.each(function(t,o){for(var u=0;u<e.length;u++){var a=e[s?e.length-u-1:u];d(a,function(e){e.nodeName!=null&&e.nodeName.toUpperCase()==="SCRIPT"&&(!e.type||e.type==="text/javascript")&&window.eval.call(window,e.innerHTML)}),i&&t<r-1&&(a=a.cloneNode(!0)),p(n,o,a)}})},g.fn[n%2?e+"To":"insert"+(n?"Before":"After")]=function(t){return g(t)[e](this),this}}),j.Z.prototype=g.fn,j.camelize=F,j.uniq=I,g.zepto=j,g}();window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(e){function t(e){return e._zid||(e._zid=h++)}function n(e,n,s,o){n=r(n);if(n.ns)var u=i(n.ns);return(c[t(e)]||[]).filter(function(e){return e&&(!n.e||e.e==n.e)&&(!n.ns||u.test(e.ns))&&(!s||t(e.fn)===t(s))&&(!o||e.sel==o)})}function r(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function i(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function s(t,n,r){e.isObject(t)?e.each(t,r):t.split(/\s/).forEach(function(e){r(e,n)})}function o(n,i,o,u,a,f){f=!!f;var l=t(n),h=c[l]||(c[l]=[]);s(i,o,function(t,i){var s=a&&a(i,t),o=s||i,l=function(e){var t=o.apply(n,[e].concat(e.data));return t===!1&&e.preventDefault(),t},c=e.extend(r(t),{fn:i,proxy:l,sel:u,del:s,i:h.length});h.push(c),n.addEventListener(c.e,l,f)})}function u(e,r,i,o){var u=t(e);s(r||"",i,function(t,r){n(e,t,r,o).forEach(function(t){delete c[u][t.i],e.removeEventListener(t.e,t.proxy,!1)})})}function a(t){var n=e.extend({originalEvent:t},t);return e.each(m,function(e,r){n[e]=function(){return this[r]=d,t[e].apply(t,arguments)},n[r]=v}),n}function f(e){if(!("defaultPrevented"in e)){e.defaultPrevented=!1;var t=e.preventDefault;e.preventDefault=function(){this.defaultPrevented=!0,t.call(this)}}}var l=e.zepto.qsa,c={},h=1,p={};p.click=p.mousedown=p.mouseup=p.mousemove="MouseEvents",e.event={add:o,remove:u},e.proxy=function(n,r){if(e.isFunction(n)){var i=function(){return n.apply(r,arguments)};return i._zid=t(n),i}if(typeof r=="string")return e.proxy(n[r],n);throw new TypeError("expected function")},e.fn.bind=function(e,t){return this.each(function(){o(this,e,t)})},e.fn.unbind=function(e,t){return this.each(function(){u(this,e,t)})},e.fn.one=function(e,t){return this.each(function(n,r){o(this,e,t,null,function(e,t){return function(){var n=e.apply(r,arguments);return u(r,t,e),n}})})};var d=function(){return!0},v=function(){return!1},m={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(t,n,r){var i=!1;if(n=="blur"||n=="focus")e.iswebkit?n=n=="blur"?"focusout":n=="focus"?"focusin":n:i=!0;return this.each(function(s,u){o(u,n,r,t,function(n){return function(r){var i,s=e(r.target).closest(t,u).get(0);if(s)return i=e.extend(a(r),{currentTarget:s,liveFired:u}),n.apply(s,[i].concat([].slice.call(arguments,1)))}},i)})},e.fn.undelegate=function(e,t,n){return this.each(function(){u(this,t,n,e)})},e.fn.live=function(t,n){return e(document.body).delegate(this.selector,t,n),this},e.fn.die=function(t,n){return e(document.body).undelegate(this.selector,t,n),this},e.fn.on=function(t,n,r){return n==undefined||e.isFunction(n)?this.bind(t,n):this.delegate(n,t,r)},e.fn.off=function(t,n,r){return n==undefined||e.isFunction(n)?this.unbind(t,n):this.undelegate(n,t,r)},e.fn.trigger=function(t,n){return typeof t=="string"&&(t=e.Event(t)),f(t),t.data=n,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(t)})},e.fn.triggerHandler=function(t,r){var i,s;return this.each(function(o,u){i=a(typeof t=="string"?e.Event(t):t),i.data=r,i.target=u,e.each(n(u,t.type||t),function(e,t){s=t.proxy(i);if(i.isImmediatePropagationStopped())return!1})}),s},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return this.bind(t,e)}}),["focus","blur"].forEach(function(t){e.fn[t]=function(e){if(e)this.bind(t,e);else if(this.length)try{this.get(0)[t]()}catch(n){}return this}}),e.Event=function(e,t){var n=document.createEvent(p[e]||"Events"),r=!0;if(t)for(var i in t)i=="bubbles"?r=!!t[i]:n[i]=t[i];return n.initEvent(e,r,!0,null,null,null,null,null,null,null,null,null,null,null,null),n}}(Zepto),function(e){function t(e){var t=this.os={},n=this.browser={},r=e.match(/WebKit\/([\d.]+)/),i=e.match(/(Android)\s+([\d.]+)/),s=e.match(/(iPad).*OS\s([\d_]+)/),o=!s&&e.match(/(iPhone\sOS)\s([\d_]+)/),u=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),a=u&&e.match(/TouchPad/),f=e.match(/Kindle\/([\d.]+)/),l=e.match(/Silk\/([\d._]+)/),c=e.match(/(BlackBerry).*Version\/([\d.]+)/);if(n.webkit=!!r)n.version=r[1];i&&(t.android=!0,t.version=i[2]),o&&(t.ios=t.iphone=!0,t.version=o[2].replace(/_/g,".")),s&&(t.ios=t.ipad=!0,t.version=s[2].replace(/_/g,".")),u&&(t.webos=!0,t.version=u[2]),a&&(t.touchpad=!0),c&&(t.blackberry=!0,t.version=c[2]),f&&(t.kindle=!0,t.version=f[1]),l&&(n.silk=!0,n.version=l[1]),!l&&t.android&&e.match(/Kindle Fire/)&&(n.silk=!0)}t.call(e,navigator.userAgent),e.__detect=t}(Zepto),function(e,t){function n(e){return e.toLowerCase()}function r(e){return s?s+e:n(e)}var i="",s,o,u,a={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},f=window.document,l=f.createElement("div"),c=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,h={};e.each(a,function(e,r){if(l.style[e+"TransitionProperty"]!==t)return i="-"+n(e)+"-",s=r,!1}),h[i+"transition-property"]=h[i+"transition-duration"]=h[i+"transition-timing-function"]=h[i+"animation-name"]=h[i+"animation-duration"]="",e.fx={off:s===t&&l.style.transitionProperty===t,cssPrefix:i,transitionEnd:r("TransitionEnd"),animationEnd:r("AnimationEnd")},e.fn.animate=function(t,n,r,i){return e.isObject(n)&&(r=n.easing,i=n.complete,n=n.duration),n&&(n/=1e3),this.anim(t,n,r,i)},e.fn.anim=function(n,r,s,o){var u,a={},f,l=this,p,d=e.fx.transitionEnd;r===t&&(r=.4),e.fx.off&&(r=0);if(typeof n=="string")a[i+"animation-name"]=n,a[i+"animation-duration"]=r+"s",d=e.fx.animationEnd;else{for(f in n)c.test(f)?(u||(u=[]),u.push(f+"("+n[f]+")")):a[f]=n[f];u&&(a[i+"transform"]=u.join(" ")),!e.fx.off&&typeof n=="object"&&(a[i+"transition-property"]=Object.keys(n).join(", "),a[i+"transition-duration"]=r+"s",a[i+"transition-timing-function"]=s||"linear")}return p=function(t){if(typeof t!="undefined"){if(t.target!==t.currentTarget)return;e(t.target).unbind(d,arguments.callee)}e(this).css(h),o&&o.call(this)},r>0&&this.bind(d,p),setTimeout(function(){l.css(a),r<=0&&setTimeout(function(){l.each(function(){p.call(this)})},0)},0),this},l=null}(Zepto),function($){function triggerAndReturn(e,t,n){var r=$.Event(t);return $(e).trigger(r,n),!r.defaultPrevented}function triggerGlobal(e,t,n,r){if(e.global)return triggerAndReturn(t||document,n,r)}function ajaxStart(e){e.global&&$.active++===0&&triggerGlobal(e,null,"ajaxStart")}function ajaxStop(e){e.global&&!--$.active&&triggerGlobal(e,null,"ajaxStop")}function ajaxBeforeSend(e,t){var n=t.context;if(t.beforeSend.call(n,e,t)===!1||triggerGlobal(t,n,"ajaxBeforeSend",[e,t])===!1)return!1;triggerGlobal(t,n,"ajaxSend",[e,t])}function ajaxSuccess(e,t,n){var r=n.context,i="success";n.success.call(r,e,i,t),triggerGlobal(n,r,"ajaxSuccess",[t,n,e]),ajaxComplete(i,t,n)}function ajaxError(e,t,n,r){var i=r.context;r.error.call(i,n,t,e),triggerGlobal(r,i,"ajaxError",[n,r,e]),ajaxComplete(t,n,r)}function ajaxComplete(e,t,n){var r=n.context;n.complete.call(r,t,e),triggerGlobal(n,r,"ajaxComplete",[t,n]),ajaxStop(n)}function empty(){}function mimeToDataType(e){return e&&(e==htmlType?"html":e==jsonType?"json":scriptTypeRE.test(e)?"script":xmlTypeRE.test(e)&&"xml")||"text"}function appendQuery(e,t){return(e+"&"+t).replace(/[&?]{1,2}/,"?")}function serializeData(e){isObject(e.data)&&(e.data=$.param(e.data)),e.data&&(!e.type||e.type.toUpperCase()=="GET")&&(e.url=appendQuery(e.url,e.data))}function serialize(e,t,n,r){var i=$.isArray(t);$.each(t,function(t,s){r&&(t=n?r:r+"["+(i?"":t)+"]"),!r&&i?e.add(s.name,s.value):(n?$.isArray(s):isObject(s))?serialize(e,s,n,t):e.add(t,s)})}var jsonpID=0,isObject=$.isObject,document=window.document,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/;$.active=0,$.ajaxJSONP=function(e){var t="jsonp"+ ++jsonpID,n=document.createElement("script"),r=function(){$(n).remove(),t in window&&(window[t]=empty),ajaxComplete("abort",i,e)},i={abort:r},s;return e.error&&(n.onerror=function(){i.abort(),e.error()}),window[t]=function(r){clearTimeout(s),$(n).remove(),delete window[t],ajaxSuccess(r,i,e)},serializeData(e),n.src=e.url.replace(/=\?/,"="+t),$("head").append(n),e.timeout>0&&(s=setTimeout(function(){i.abort(),ajaxComplete("timeout",i,e)},e.timeout)),i},$.ajaxSettings={type:"GET",beforeSend:empty,success:empty,error:empty,complete:empty,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:jsonType,xml:"application/xml, text/xml",html:htmlType,text:"text/plain"},crossDomain:!1,timeout:0},$.ajax=function(options){var settings=$.extend({},options||{});for(key in $.ajaxSettings)settings[key]===undefined&&(settings[key]=$.ajaxSettings[key]);ajaxStart(settings),settings.crossDomain||(settings.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(settings.url)&&RegExp.$2!=window.location.host);var dataType=settings.dataType,hasPlaceholder=/=\?/.test(settings.url);if(dataType=="jsonp"||hasPlaceholder)return hasPlaceholder||(settings.url=appendQuery(settings.url,"callback=?")),$.ajaxJSONP(settings);settings.url||(settings.url=window.location.toString()),serializeData(settings);var mime=settings.accepts[dataType],baseHeaders={},protocol=/^([\w-]+:)\/\//.test(settings.url)?RegExp.$1:window.location.protocol,xhr=$.ajaxSettings.xhr(),abortTimeout;settings.crossDomain||(baseHeaders["X-Requested-With"]="XMLHttpRequest"),mime&&(baseHeaders.Accept=mime,mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),xhr.overrideMimeType&&xhr.overrideMimeType(mime));if(settings.contentType||settings.data&&settings.type.toUpperCase()!="GET")baseHeaders["Content-Type"]=settings.contentType||"application/x-www-form-urlencoded";settings.headers=$.extend(baseHeaders,settings.headers||
{}),xhr.onreadystatechange=function(){if(xhr.readyState==4){clearTimeout(abortTimeout);var result,error=!1;if(xhr.status>=200&&xhr.status<300||xhr.status==304||xhr.status==0&&protocol=="file:"){dataType=dataType||mimeToDataType(xhr.getResponseHeader("content-type")),result=xhr.responseText;try{dataType=="script"?(1,eval)(result):dataType=="xml"?result=xhr.responseXML:dataType=="json"&&(result=blankRE.test(result)?null:JSON.parse(result))}catch(e){error=e}error?ajaxError(error,"parsererror",xhr,settings):ajaxSuccess(result,xhr,settings)}else ajaxError(null,"error",xhr,settings)}};var async="async"in settings?settings.async:!0;xhr.open(settings.type,settings.url,async);for(name in settings.headers)xhr.setRequestHeader(name,settings.headers[name]);return ajaxBeforeSend(xhr,settings)===!1?(xhr.abort(),!1):(settings.timeout>0&&(abortTimeout=setTimeout(function(){xhr.onreadystatechange=empty,xhr.abort(),ajaxError(null,"timeout",xhr,settings)},settings.timeout)),xhr.send(settings.data?settings.data:null),xhr)},$.get=function(e,t){return $.ajax({url:e,success:t})},$.post=function(e,t,n,r){return $.isFunction(t)&&(r=r||n,n=t,t=null),$.ajax({type:"POST",url:e,data:t,success:n,dataType:r})},$.getJSON=function(e,t){return $.ajax({url:e,success:t,dataType:"json"})},$.fn.load=function(e,t){if(!this.length)return this;var n=this,r=e.split(/\s/),i;return r.length>1&&(e=r[0],i=r[1]),$.get(e,function(e){n.html(i?$(document.createElement("div")).html(e.replace(rscript,"")).find(i).html():e),t&&t.call(n)}),this};var escape=encodeURIComponent;$.param=function(e,t){var n=[];return n.add=function(e,t){this.push(escape(e)+"="+escape(t))},serialize(n,e,t),n.join("&").replace("%20","+")}}(Zepto),function(e){e.fn.serializeArray=function(){var t=[],n;return e(Array.prototype.slice.call(this.get(0).elements)).each(function(){n=e(this);var r=n.attr("type");this.nodeName.toLowerCase()!="fieldset"&&!this.disabled&&r!="submit"&&r!="reset"&&r!="button"&&(r!="radio"&&r!="checkbox"||this.checked)&&t.push({name:n.attr("name"),value:n.val()})}),t},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(t)this.bind("submit",t);else if(this.length){var n=e.Event("submit");this.eq(0).trigger(n),n.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(e){function t(e){return"tagName"in e?e:e.parentNode}function n(e,t,n,r){var i=Math.abs(e-t),s=Math.abs(n-r);return i>=s?e-t>0?"Left":"Right":n-r>0?"Up":"Down"}function r(){a=null,s.last&&(s.el.trigger("longTap"),s={})}function i(){a&&clearTimeout(a),a=null}var s={},o,u=750,a;e(document).ready(function(){var l,p;e(document.body).bind("touchstart",function(n){l=Date.now(),p=l-(s.last||l),s.el=e(t(n.touches[0].target)),o&&clearTimeout(o),s.x1=n.touches[0].pageX,s.y1=n.touches[0].pageY,p>0&&p<=250&&(s.isDoubleTap=!0),s.last=l,a=setTimeout(r,u)}).bind("touchmove",function(e){i(),s.x2=e.touches[0].pageX,s.y2=e.touches[0].pageY}).bind("touchend",function(e){i(),s.isDoubleTap?(s.el.trigger("doubleTap"),s={}):s.x2&&Math.abs(s.x1-s.x2)>30||s.y2&&Math.abs(s.y1-s.y2)>30?(s.el.trigger("swipe")&&s.el.trigger("swipe"+n(s.x1,s.x2,s.y1,s.y2)),s={}):"last"in s&&(s.el.trigger("tap"),o=setTimeout(function(){o=null,s.el.trigger("singleTap"),s={}},250))}).bind("touchcancel",function(){o&&clearTimeout(o),a&&clearTimeout(a),a=o=null,s={}})}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(t){e.fn[t]=function(e){return this.bind(t,e)}})}(Zepto),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=r.unshift,l=i.toString,c=i.hasOwnProperty,h=r.forEach,p=r.map,d=r.reduce,v=r.reduceRight,m=r.filter,g=r.every,y=r.some,b=r.indexOf,w=r.lastIndexOf,E=Array.isArray,S=Object.keys,x=s.bind,T=function(e){if(e instanceof T)return e;if(!(this instanceof T))return new T(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=T),exports._=T):e._=T,T.VERSION="1.4.2";var N=T.each=T.forEach=function(e,t,r){if(e==null)return;if(h&&e.forEach===h)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(T.has(e,o)&&t.call(r,e[o],o,e)===n)return};T.map=T.collect=function(e,t,n){var r=[];return e==null?r:p&&e.map===p?e.map(t,n):(N(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)},T.reduce=T.foldl=T.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduce===d)return r&&(t=T.bind(t,r)),i?e.reduce(t,n):e.reduce(t);N(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.reduceRight=T.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(v&&e.reduceRight===v)return r&&(t=T.bind(t,r)),arguments.length>2?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=T.keys(e);s=o.length}N(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.find=T.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},T.filter=T.select=function(e,t,n){var r=[];return e==null?r:m&&e.filter===m?e.filter(t,n):(N(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},T.reject=function(e,t,n){var r=[];return e==null?r:(N(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r)},T.every=T.all=function(e,t,r){t||(t=T.identity);var i=!0;return e==null?i:g&&e.every===g?e.every(t,r):(N(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=T.some=T.any=function(e,t,r){t||(t=T.identity);var i=!1;return e==null?i:y&&e.some===y?e.some(t,r):(N(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};T.contains=T.include=function(e,t){var n=!1;return e==null?n:b&&e.indexOf===b?e.indexOf(t)!=-1:(n=C(e,function(e){return e===t}),n)},T.invoke=function(e,t){var n=u.call(arguments,2);return T.map(e,function(e){return(T.isFunction(t)?t:e[t]).apply(e,n)})},T.pluck=function(e,t){return T.map(e,function(e){return e[t]})},T.where=function(e,t){return T.isEmpty(t)?[]:T.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},T.max=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&T.isEmpty(e))return-Infinity;var r={computed:-Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},T.min=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&T.isEmpty(e))return Infinity;var r={computed:Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},T.shuffle=function(e){var t,n=0,r=[];return N(e,function(e){t=T.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return T.isFunction(e)?e:function(t){return t[e]}};T.sortBy=function(e,t,n){var r=k(t);return T.pluck(T.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t);return N(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};T.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(T.has(e,t)?e[t]:e[t]=[]).push(n)})},T.countBy=function(e,t,n){return L(e,t,n,function(e,t,n){T.has(e,t)||(e[t]=0),e[t]++})},T.sortedIndex=function(e,t,n,r){n=n==null?T.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},T.toArray=function(e){return e?e.length===+e.length?u.call(e):T.values(e):[]},T.size=function(e){return e.length===+e.length?e.length:T.keys(e).length},T.first=T.head=T.take=function(e,t,n){return t!=null&&!n?u.call(e,0,t):e[0]},T.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},T.last=function(e,t,n){return t!=null&&!n?u.call(e,Math.max(e.length-t,0)):e[e.length-1]},T.rest=T.tail=T.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},T.compact=function(e){return T.filter(e,function(e){return!!e})};var A=function(e,t,n){return N(e,function(e){T.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};T.flatten=function(e,t){return A(e,t,[])},T.without=function(e){return T.difference(e,u.call(arguments,1))},T.uniq=T.unique=function(e,t,n,r){var i=n?T.map(e,n,r):e,s=[],o=[];return N(i,function(n,r){if(t?!r||o[o.length-1]!==n:!T.contains(o,n))o.push(n),s.push(e[r])}),s},T.union=function(){return T.uniq(a.apply(r,arguments))},T.intersection=function(e){var t=u.call(arguments,1);return T.filter(T.uniq(e),function(e){return T.every(t,function(t){return T.indexOf(t,e)>=0})})},T.difference=function(e){var t=a.apply(r,u.call(arguments,1));return T.filter(e,function(e){return!T.contains(t,e)})},T.zip=function(){var e=u.call(arguments),t=T.max(T.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=T.pluck(e,""+r);return n},T.object=function(e,t){var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},T.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=T.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},T.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(w&&e.lastIndexOf===w)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},T.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};T.bind=function(t,n){var r,i;if(t.bind===x&&x)return x.apply(t,u.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return i=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=t.prototype;var e=new O,s=t.apply(e,i.concat(u.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(u.call(arguments)))}},T.bindAll=function(e){var t=u.call(arguments,1);return t.length==0&&(t=T.functions(e)),N(t,function(t){e[t]=T.bind(e[t],e)}),e},T.memoize=function(e,t){var n={};return t||(t=T.identity),function(){var r=t.apply(this,arguments);return T.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},T.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},T.defer=function(e){return T.delay.apply(T,[e,1].concat(u.call(arguments,1)))},T.throttle=function(e,t){var n,r,i,s,o,u,a=T.debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;var f=function(){i=null,o&&(u=e.apply(n,r)),a()};return i||(i=setTimeout(f,t)),s?o=!0:(s=!0,u=e.apply(n,r)),a(),u}},T.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},T.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},T.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},T.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},T.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},T.keys=S||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)T.has(e,n)&&(t[t.length]=n);return t},T.values=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push(e[n]);return t},T.pairs=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push([n,e[n]]);return t},T.invert=function(e){var t={};for(var n in e)T.has(e,n)&&(t[e[n]]=n);return t},T.functions=T.methods=function(e){var t=[];for(var n in e)T.isFunction(e[n])&&t.push(n);return t.sort()},T.extend=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},T.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return N(n,function(n){n in e&&(t[n]=e[n])}),t},T.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)T.contains(n,i)||(t[i]=e[i]);return t},T.defaults=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},T.clone=function(e){return T.isObject(e)?T.isArray(e)?e.slice():T.extend({},e):e},T.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof T&&(e=e._wrapped),t instanceof T&&(t=t._wrapped);var i=l.call(e);if(i!=l.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if(i=="[object Array]"){o=e.length,u=o==t.length;if(u)while(o--)if(!(u=M(e[o],t[o],n,r)))break}else{var a=e.constructor,f=t.constructor;if(a!==f&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(f)&&f instanceof f))return!1;for(var c in e)if(T.has(e,c)){o++;if(!(u=T.has(t,c)&&M(e[c],t[c],n,r)))break}if(u){for(c in t)if(T.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};T.isEqual=function(e,t){return M(e,t,[],[])},T.isEmpty=function(e){if(e==null)return!0;if(T.isArray(e)||T.isString(e))return e.length===0;for(var t in e)if(T.has(e,t))return!1;return!0},T.isElement=function(e){return!!e&&e.nodeType===1},T.isArray=E||function(e){return l.call(e)=="[object Array]"},T.isObject=function(e){return e===Object(e)},N(["Arguments","Function","String","Number","Date","RegExp"],function(e){T["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),T.isArguments(arguments)||(T.isArguments=function(e){return!!e&&!!T.has(e,"callee")}),typeof /./!="function"&&(T.isFunction=function(e){return typeof e=="function"}),T.isFinite=function(e){return T.isNumber(e)&&isFinite(e)},T.isNaN=function(e){return T.isNumber(e)&&e!=+e},T.isBoolean=function(e){return e===!0||e===!1||l.call(e)=="[object Boolean]"},T.isNull=function(e){return e===null},T.isUndefined=function(e){return e===void 0},T.has=function(e,t){return c.call(e,t)},T.noConflict=function(){return e._=t,this},T.identity=function(e){return e},T.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},T.random=function(e,t){return t==null&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=T.invert(_.escape);var D={escape:new RegExp("["+T.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(_.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(e){T[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),T.result=function(e,t){if(e==null)return null;var n=e[t];return T.isFunction(n)?n.call(e):n},T.mixin=function(e){N(T.functions(e),function(t){var n=T[t]=e[t];T.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(T,e))}})};var P=0;T.uniqueId=function(e){var t=P++;return e?e+t:t},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(e,t,n){n=T.defaults({},n,T.templateSettings);var r=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){s+=e.slice(i,u).replace(j,function(e){return"\\"+B[e]}),s+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?"'+\n((__t=("+r+"))==null?'':__t)+\n'":o?"';\n"+o+"\n__p+='":"",i=u+t.length}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,T);var a=function(e){return o.call(this,e,T)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},T.chain=function(e){return T(e).chain()};var F=function(e){return this._chain?T(e).chain():e};T.mixin(T),N(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];T.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),N(["concat","join","slice"],function(e){var t=r[e];T.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){var e=this,t=e.Backbone,n=Array.prototype.slice,r=Array.prototype.splice,i;typeof exports!="undefined"?i=exports:i=e.Backbone={},i.VERSION="0.9.2";var s=e._;!s&&typeof require!="undefined"&&(s=require("underscore"));var o=e.jQuery||e.Zepto||e.ender;i.setDomLibrary=function(e){o=e},i.noConflict=function(){return e.Backbone=t,this},i.emulateHTTP=!1,i.emulateJSON=!1;var u=/\s+/,a=i.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;e=e.split(u),r=this._callbacks||(this._callbacks={});while(i=e.shift())a=r[i],s=a?a.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s};return this},off:function(e,t,n){var r,i,o,a,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(u):s.keys(i);while(r=e.shift()){o=i[r],delete i[r];if(!o||!t&&!n)continue;a=o.tail;while((o=o.next)!==a)f=o.callback,l=o.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,r,i,s,o,a,f;if(!(i=this._callbacks))return this;a=i.all,e=e.split(u),f=n.call(arguments,1);while(t=e.shift()){if(r=i[t]){s=r.tail;while((r=r.next)!==s)r.callback.apply(r.context||this,f)}if(r=a){s=r.tail,o=[t].concat(f);while((r=r.next)!==s)r.callback.apply(r.context||this,o)}}return this}};a.bind=a.on,a.unbind=a.off;var f=i.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=C(this,"defaults"))e=s.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(f.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=s.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof f&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,l=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){o=r[i];if(!s.isEqual(a[i],o)||n.unset&&s.has(a,i))delete l[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=o,!s.isEqual(c[i],o)||s.has(a,i)!=s.has(c,i)?(this.changed[i]=o,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(s.clone(this.attributes),e)},fetch:function(e){e=e?s.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},save:function(e,t,n){var r,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?s.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;o=s.clone(this.attributes)}var u=s.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var o=a.parse(e,i);n.wait&&(delete n.wait,o=s.extend(r||{},o));if(!a.set(o,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=i.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||i.sync).call(this,l,this,n);return n.wait&&this.set(o,u),c},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=i.wrapError(e.error,t,e);var o=(this.sync||i.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var e=C(this,"urlRoot")||C(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=s.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!s.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?s.has(this.changed,e):!s.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(s.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var l=i.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};s.extend(l.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,i,o,u,a,f,l={},c={},h=[];t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,o=e.length;n<o;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,o=e.length;n<o;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=o,i=t.at!=null?t.at:this.models.length,r.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,o=this.models.length;n<o;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,o;t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){o=this.getByCid(e[n])||this.get(e[n]);if(!o)continue;delete this._byId[o.id],delete this._byCid[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=s.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return s.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?s.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return s(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof f)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(c,function(e){l.prototype[e]=function(){return s[e].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=i.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,d=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,a,{initialize:function(){},route:function(e,t,n){return i.history||(i.history=new m),s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),i.history.route(e,s.bind(function(r){var s=this._extractParameters(e,r);n&&n.apply(this,s),this.trigger.apply(this,["route:"+t].concat(s)),i.history.trigger("route",this,t,s)},this)),this},navigate:function(e,t){i.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"([^/]+)").replace(d,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var m=i.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},g=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,s.extend(m.prototype,a,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(g,"")},start:function(e){if(m.started)throw new Error("Backbone.history has already been started");m.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,u=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!u)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&u&&i.hash&&(this.fragment=this.getHash().replace(g,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){o(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!m.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(g,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var b=i.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&o(r).attr(t),n&&o(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o?e:o(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=C(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];s.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(w),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,o===""?this.$el.bind(i,n):this.$el.delegate(o,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},this.options,e));for(var t=0,n=E.length;t<n;t++){var r=E[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=C(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var S=function(e,t){var n=N(this,e,t);return n.extend=this.extend,n};f.extend=l.extend=h.extend=b.extend=S;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(e,t,n){var r=x[e];n||(n={});var u={type:r,dataType:"json"};return n.url||(u.url=C(t,"url")||k()),!n.data&&t&&(e=="create"||e=="update")&&(u.contentType="application/json",u.data=JSON.stringify(t.toJSON())),i.emulateJSON&&(u.contentType="application/x-www-form-urlencoded",u.data=u.data?{model:u.data}:{}),i.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(i
.emulateJSON&&(u.data._method=r),u.type="POST",u.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),u.type!=="GET"&&!i.emulateJSON&&(u.processData=!1),o.ajax(s.extend(u,n))},i.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var T=function(){},N=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},s.extend(r,e),T.prototype=e.prototype,r.prototype=new T,t&&s.extend(r.prototype,t),n&&s.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},C=function(e,t){return!e||!e[t]?null:s.isFunction(e[t])?e[t]():e[t]},k=function(){throw new Error('A "url" property or function must be specified')}}.call(this),window.Muzhi||(Muzhi={}),window.application||(application={}),window.application.init=function(){Muzhi.router=new Muzhi.Router,Backbone.history.start(),linkfocus("a")},window.lazyload={init:function(e){var t=this;t.img.init()},img:{trigger:function(){var e=this,t=e.op,n=e.isPhone,r=n&&"touchend"||"scroll";e.prevlist&&e.prevlist.each(function(e,t){t&&(t.onerror=t.onload=null)}),e.imglist=$("img.lazy"),e.prevlist=$(e.imglist.concat()),$(window).trigger(r)},init:function(){var e=this,t=5,n=200,r=navigator.appVersion.match(/(iPhone\sOS)\s([\d_]+)/),i=r&&!0||!1,s=i&&r[2].split("_");s=s&&parseFloat(s.length>1?s.splice(0,2).join("."):s[0],10),i=e.isPhone=i&&s<6;if(i){var o,u;$(window).on("touchstart",function(e){o={sy:window.scrollY,time:Date.now()},u&&clearTimeout(u)}).on("touchend",function(r){if(r&&r.changedTouches){var i=Math.abs(window.scrollY-o.sy);if(i>t){var s=Date.now()-o.time;u=setTimeout(function(){e.changeimg(),o={},clearTimeout(u),u=null},s>n?0:200)}}else e.changeimg()}).on("touchcancel",function(){u&&clearTimeout(u),o={}})}else $(window).on("scroll",function(){e.changeimg()});e.trigger()},_inViewport:function(e,t){var n=window.pageYOffset,r=window.pageYOffset+window.innerHeight,i=e.offset().top;return i>=n&&i+(t||-100)<=r},changeimg:function(){function t(t,n){var r=t.attr("dataimg");t.attr("src",r),t[0].onload||(t[0].onload=function(){$(this).removeClass("lazy").removeAttr("dataimg"),e.imglist[n]=null,this.onerror=this.onload=null},t[0].onerror=function(){this.src="http://a.tbcdn.cn/mw/s/common/icons/nopic/no-90.png",$(this).removeClass("lazy").removeAttr("dataimg"),e.imglist[n]=null,this.onerror=this.onload=null})}var e=this,n=$("img.hascomment");n.length>0&&e._inViewport(n,20)&&$(document.body).trigger("list:popcomment",[n]),e.imglist.each(function(n,r){if(!r)return;var i=$(r);if(!e._inViewport(i))return;t(i,n)})}}};var appVersion=navigator.appVersion,webkitTest=/webkit/gi,androidTest=/android/gi,win=$(window),T_float=['<div class="c-float-popWrap msgMode hide">','<div class="c-float-modePop">','<div class="warnMsg"></div>','<div class="content"></div>',"</div>","</div>"].join(""),E_float=$(T_float),E_floatMsg=E_float.find(".warnMsg"),E_floatContent=E_float.find(".content"),initDom=!1,domContainer="#tbh5v0",flashTimeoutId;$.extend(ModePop.prototype,{_init:function(){var e=this,t=e._options,n=t.mode,r=t.text,i=t.content,s=t.callback,o=t.background,u=t.useTap?"tap":"click",a=E_float.attr("class");a=a.replace(/(msg|alert|confirm)Mode/i,n+"Mode"),E_float.attr("class",a),o&&E_float.css("background",o),r&&E_floatMsg.html(r),i&&E_floatContent.html(i),initDom||(initDom=!0,$(domContainer).append(E_float),win.on("resize",function(){setTimeout(function(){e._pos()},500)}))},_pos:function(){var e=this,t=document,n=t.documentElement,r=t.body,i,s,o,u,a,f;e.isHide()||(i=r.scrollTop,s=r.scrollLeft,o=n.clientWidth,u=n.clientHeight,a=E_float.width(),f=E_float.height(),E_float.css({top:i+(u-f)/2,left:s+(o-a)/2}))},isShow:function(){return E_float.hasClass("show")},isHide:function(){return E_float.hasClass("hide")},_cbShow:function(){var e=this,t=e._options,n=t.onShow;E_float.css("opacity","1").addClass("show"),n&&n.call(e)},show:function(){var e=this;flashTimeoutId&&(clearTimeout(flashTimeoutId),flashTimeoutId=undefined),e.isShow()?e._cbShow():(E_float.css("opacity","0").removeClass("hide"),e._pos(),setTimeout(function(){e._cbShow()},300),setTimeout(function(){E_float.animate({opacity:"1"},300,"linear")},1))},_cbHide:function(){var e=this,t=e._options,n=t.onHide;E_float.css("opacity","0").addClass("hide"),n&&n.call(e)},hide:function(){var e=this;e.isHide()?e._cbHide():(E_float.css("opacity","1").removeClass("show"),setTimeout(function(){e._cbHide()},300),setTimeout(function(){E_float.animate({opacity:"0"},300,"linear")},1))},flash:function(e){var t=this;opt=t._options,opt.onShow=function(){flashTimeoutId=setTimeout(function(){flashTimeoutId&&t.hide()},e)},t.show()}}),window.notification=new function(){this.flash=function(e,t,n){arguments.length==2&&typeof arguments[1]=="number"&&(n=arguments[1],t=undefined);var r=new ModePop({mode:"msg",text:e,background:t});return r.flash(n||2e3),r}},window.PageNav=function(t){this.init(t)},PageNav.prototype={setIndex:function(e){var t=this;e=Number(e),isNaN(e)&&(e=1),e>t.pageCount&&(e=t.pageCount),e<=0&&(e=1),t.index=e,t.renderPage()},init:function(e){this.$container||(this.$container=$(e.id)),this.index=Number(e.index?e.index:1),this.pageCount=Number(e.pageCount?e.pageCount:1),this.preFix=e.preFix?e.preFix:"!page/",this.objId=e.objId?e.objId:"Z",this.disableHash=e.disableHash,this.oldIndex=-1;var t=this.preFix.toString().length;this.preFix[t-1]!="/"&&(this.preFix+="/"),isNaN(this.index)&&(this.index=1),this.index>this.pageCount&&(this.index=this.pageCount),this.index<=0&&(this.index=1),this.createDom(),this.eventAttach(),this.parseHash(),this.renderPage()},parseHash:function(){var e=this,t=location.hash,n=t.substr(t.lastIndexOf("/")+1),r=[],i=0,s=[];r=n.split("-");for(var o=0;o<r.length;o++){s=r[o].split("");var u=s.shift();if(u==this.objId){i=Number(s.join(""));if(isNaN(i)||i<=0)e.index=1;i>e.pageCount&&(e.index=e.pageCount),e.index=i}}},setContainer:function(e){this.$container=$(e)},getObjId:function(){return this.objId},changeHash:function(){var e=this,t=location.hash;if(t=="")location.hash=e.preFix+"-"+e.objId+e.index;else{var n=t.lastIndexOf(e.objId),r=n;if(n==-1)location.hash+="-"+e.objId+e.index;else{for(;;){r++;if(t[r]=="-"||!t[r])break}t=t.replace(t.substring(n,r),e.objId+e.index),location.hash=t}}},createDom:function(){var e=this;e.$container.empty();var t=['<section class="c-p-sec">','<div class="c-p-pre">','<span class="c-p-p">',"<em></em>","</span><a>上一页</a>","</div>",'<div class="c-p-cur">','<div class="c-p-arrow c-p-down"><span></span><span></span></div>','<select class="c-p-select">',"</select></div>",'<div class="c-p-next">','<a>下一页</a><span class="c-p-p">',"<em></em>","</span>","</div>","</section>"];e.$container.html(t.join("")),$("select",e.$container).empty(),t=[];for(var n=1;n<=e.pageCount;n++)t[n-1]="<option>第"+n+"页</option>";$("select",e.$container).append(t.join(""))},renderPage:function(){var e=this,t=$("option",e.$container).length,n=$(".c-p-pre",e.$container),r=$(".c-p-next",e.$container);t<=1?(n.addClass("c-p-grey"),r.addClass("c-p-grey"),t=1):e.index==1?(n.addClass("c-p-grey"),t>1&&r.removeClass("c-p-grey")):e.index==t?(r.addClass("c-p-grey"),t>1&&n.removeClass("c-p-grey")):e.index>1&&e.index<t&&(n.removeClass("c-p-grey"),r.removeClass("c-p-grey"));var i=e.index+"/"+t;$(".c-p-arrow span:first-child",e.$container).text(i),$("select",e.$container).get(0).selectedIndex=this.index-1,n=null,r=null},eventDetach:function(){var e=this,t=$(e.$container);t.undelegate("select","mousedown",e.modifyArr),t.undelegate("select","blur",e.blur),t.find(".c-p-pre").undelegate("a","click",e.lastPage),t.find(".c-p-next").undelegate("a","click",e.nextPage),t.undelegate("select","change",e.selectChange),t=null},eventAttach:function(){var e=this,t=$(e.$container);t.delegate("select","mousedown",e.modifyArr=function(t){$(".c-p-arrow",e.$container).removeClass("c-p-down").addClass("c-p-up")}),t.delegate("select","blur",e.blur=function(t){$(".c-p-arrow",e.$container).removeClass("c-p-up").addClass("c-p-down")}),t.find(".c-p-pre").delegate("a","click",e.lastPage=function(t){t.preventDefault();if($(this).parent().hasClass("c-p-grey"))return!1;e.index--,e.renderPage(),e.disableHash?e.$container.trigger("P:switchPage",{index:e.index,type:"pre"}):e.changeHash(),e.oldIndex=e.index}),t.find(".c-p-next").delegate("a","click",e.nextPage=function(t){t.preventDefault();if($(this).parent().hasClass("c-p-grey"))return!1;e.index++,e.renderPage(),e.disableHash?e.$container.trigger("P:switchPage",{index:e.index,type:"next"}):e.changeHash(),e.oldIndex=e.index}),t.delegate("select","change",e.selectChange=function(){e.index=$(this).get(0).selectedIndex+1;if(e.oldIndex==e.index)return;e.renderPage(),$(".c-p-arrow",e.$container).removeClass("c-p-up").addClass("c-p-down"),e.disableHash?e.$container.trigger("P:switchPage",{index:e.index,type:"select"}):e.changeHash(),e.oldIndex=e.index})},pContainer:function(){return this.$container}},window.Swipe=function(e,t){if(!e)return null;var n=this;this.options=t||{},this.index=this.options.startSlide||0,this.speed=this.options.speed||300,this.callback=this.options.callback||function(){},this.delay=this.options.auto||0,this.vertical=!!this.options.vertical,this.preload=this.options.preload,this.lazyloadClass=this.options.lazyloadClass||"lazy",this.lazyloadDataAttr=this.options.lazyloadDataAttr||"src",this.fixWidth=this.options.fixWidth,this.container=e,this.element=this.container.children[0],this.container.style.overflow="hidden",this.element.style.listStyle="none",this.element.style.margin=0,this.setup(),this.begin(),this.element.addEventListener&&(this.element.addEventListener("touchstart",this,!1),this.element.addEventListener("touchmove",this,!1),this.element.addEventListener("touchend",this,!1),this.element.addEventListener("webkitTransitionEnd",this,!1),this.element.addEventListener("msTransitionEnd",this,!1),this.element.addEventListener("oTransitionEnd",this,!1),this.element.addEventListener("transitionend",this,!1),window.addEventListener("resize",this,!1))},Swipe.prototype={setup:function(){this.slides=this.element.children,this.length=this.slides.length;if(this.length<2)return null;this.width=this.fixWidth||Math.ceil("getBoundingClientRect"in this.container?this.container.getBoundingClientRect().width:this.container.offsetWidth);if(!this.width)return null;this.container.style.visibility="hidden";if(this.vertical)this.element.style.height=Math.ceil(this.slides.length*60)+"px";else{this.element.style.width=Math.ceil(this.slides.length*this.width)+"px";var e=this.slides.length;while(e--){var t=this.slides[e];t.style.width=this.width+"px",t.style.display="table-cell",t.style.verticalAlign="top"}}this.slide(this.index,0),this.container.style.visibility="visible"},slide:function(e,t){var n=this.element.style;t==undefined&&(t=this.speed),n.webkitTransitionDuration=n.MozTransitionDuration=n.msTransitionDuration=n.OTransitionDuration=n.transitionDuration=t+"ms",this.vertical?n.MozTransform=n.webkitTransform="translate3d(0, "+ -(e*60)+"px,0)":(n.MozTransform=n.webkitTransform="translate3d("+ -(e*this.width)+"px,0,0)",n.msTransform=n.OTransform="translateX("+ -(e*this.width)+"px)"),this.index=e,this.vertical&&(this.index<0&&(this.index=0),this.index>this.length-4&&(this.index=this.length-4),n.MozTransform=n.webkitTransform="translate3d(0, "+ -(this.index*60)+"px,0)")},getPos:function(){return this.index},prev:function(e){this.delay=e||0,clearTimeout(this.interval),this.index&&this.slide(this.index-1,this.speed)},next:function(e){this.delay=e||0,clearTimeout(this.interval),this.index<this.length-1?this.slide(this.index+1,this.speed):this.slide(0,this.speed)},begin:function(){var e=this;this.interval=this.delay?setTimeout(function(){e.next(e.delay)},this.delay):0},stop:function(){this.delay=0,clearTimeout(this.interval)},resume:function(){this.delay=this.options.auto||0,this.begin()},load:function(){if(!this.preload)return;var e=this;for(var t=0;t<this.preload;t++)(function(){if(e.index+t<e.length){var n=e.slides[e.index+t];n.getAttribute("loaded")||e._loadImages(n)}})()},_loadImages:function(e){var t=e.querySelectorAll("img."+this.lazyloadClass);for(var n=0;n<t.length;n++)(function(){var r=n,s=new Image;s.onload=function(){t[r].src=this.src,e.setAttribute("loaded",!0)},s.src=t[n].getAttribute("data-"+this.lazyloadDataAttr)}).call(this)},handleEvent:function(e){switch(e.type){case"touchstart":this.onTouchStart(e);break;case"touchmove":this.onTouchMove(e);break;case"touchend":this.onTouchEnd(e);break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"transitionend":this.transitionEnd(e);break;case"resize":this.setup()}},transitionEnd:function(e){this.preload&&this.load(),this.delay&&this.begin(),this.callback(e,this.index,this.slides[this.index])},onTouchStart:function(e){this.start={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY,time:Number(new Date)},this.isScrolling=undefined,this.deltaX=0,this.deltaY=0,this.element.style.MozTransitionDuration=this.element.style.webkitTransitionDuration=0,e.stopPropagation()},onTouchMove:function(e){if(e.touches.length>1||e.scale&&e.scale!==1)return;this.deltaX=e.touches[0].pageX-this.start.pageX,this.deltaY=e.touches[0].pageY-this.start.pageY,typeof this.isScrolling=="undefined"&&(this.isScrolling=!!(this.isScrolling||Math.abs(this.deltaX)<Math.abs(e.touches[0].pageY-this.start.pageY))),!this.isScrolling&&!this.vertical&&(e.preventDefault(),clearTimeout(this.interval),this.deltaX=this.deltaX/(!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0?Math.abs(this.deltaX)/this.width+1:1),this.element.style.MozTransform=this.element.style.webkitTransform="translate3d("+(this.deltaX-this.index*this.width)+"px,0,0)",e.stopPropagation()),this.vertical&&(e.preventDefault(),clearTimeout(this.interval),this.deltaY=this.deltaY/(!this.index&&this.deltaY>0||this.index==this.length-4&&this.deltaY<0?Math.abs(this.deltaY)/60+1:1),this.element.style.MozTransform=this.element.style.webkitTransform="translate3d(0, "+(this.deltaY-this.index*60)+"px,0)",e.stopPropagation())},onTouchEnd:function(e){var t=Number(new Date)-this.start.time<250&&Math.abs(this.deltaX)>20||Math.abs(this.deltaX)>this.width/2,n=!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0;this.vertical&&(t=Number(new Date)-this.start.time<250&&Math.abs(this.deltaY)>20||Math.abs(this.deltaY)>this.width/2,n=!this.index&&this.deltaY>0||this.index==this.length-4&&this.deltaY<0),!this.isScrolling&&!this.vertical&&this.slide(this.index+(t&&!n?this.deltaX<0?1:-1:0),this.speed);if(this.vertical){var r=Math.ceil(Math.abs(this.deltaY)/60);this.slide(this.index+(t&&!n?this.deltaY<0?r:-r:0),this.speed)}e.stopPropagation()},destroy:function(){this.element.removeEventListener("touchstart",this),this.element.removeEventListener("touchmove",this),this.element.removeEventListener("touchend",this),this.element.removeEventListener("webkitTransitionEnd",this),this.element.removeEventListener("msTransitionEnd",this),this.element.removeEventListener("oTransitionEnd",this),this.element.removeEventListener("transitionend",this)}},Muzhi.mtopH5=mtop_h5(),Muzhi.uriSysType=_checkSysType(),Muzhi.Util={getMenu:function(){var e=this,t='<% _.each(navItems, function(item) { %><li><a href="#!list/<%= item.id%>/p1" id="J-catA-<%= item.id%>"><%= item.name%></a></li><%});%>',n={api:"mtop.mz.getMzNav",data:{}};Muzhi.mtopH5.getApi(n.api,"1.0",n.data,{},function(n){if(!n.data.defaultData){$("#J-catList").addClass("none");return}var r=Muzhi.menuList=n.data.defaultData.navItems;$("#J-catList").html(_.template(t,{navItems:r}));var i=location.hash.match(/!list\/(\d)/);e.setCurrentMenu(i&&i[1]||0)})},setCurrentMenu:function(e){var t=_.find(Muzhi.menuList,function(t){return t.id==e});$("a","#J-catList").removeClass("cur"),$("#J-catA-"+e).addClass("cur"),$("small",".J-filter").text(":"+t.name),$("a",".J-filter").attr("href","#!list/"+e+"/p1")},_checkLogin:function(e,t,n){if(e.data.success=="false"&&e.data.errorCode=="PP_USER_NOT_LOGIN"){var r,i=location.hostname.match(/$|\.(?:m|waptest|wapa)\.taobao\.com/gi);return t?r="http://a."+Muzhi.uriSysType+".taobao.com/i"+t+".htm?"+$("#J_moreParams").val()+(n?"&func=dxp":""):r=encodeURIComponent(location.href.split("#")[0]),location.href.indexOf("localhost")!=-1&&(i[0]=".waptest.taobao.com"),location.href="http://login"+i[0]+"/login.htm?redirectURL="+r,!1}return!0},scrollToItem:function(e){window.localStorage||console.log("不支持localstorage");if(e){var t=e.toJSON(),n=localStorage.getItem("MZReturnToList");if(n==0)return;for(var r=0,i=t.length;r<i;r++)if(t[r].mzBasePart&&t[r].mzBasePart.itemId==localStorage.getItem("MZReturnToList"))return 50+243*r}},catShow:function(){var e=location.hash.split("/")[0],t="cur";$("a","#J-tab").removeClass(t);switch(e){case"#!list":$("#J-filterLink").addClass(t);break;case"#!sold":$("#J-soldOut").addClass(t);break;case"#!my":$("#J-My").addClass(t);break;default:$("#J-filterLink").addClass(t)}$("#J-filterLink").on("click",function(e){e.preventDefault();if(!Muzhi.menuList)return;$("#J-catSel").toggleClass("none"),$(this).find(".arr").toggleClass("up")}),$("#J-catList").on("click","a",function(e){e.preventDefault(),$("#J-catSel").addClass("none");var t=$(this).attr("href");$("a",".J-filter").attr("href",t),$(".arr",".J-filter").removeClass("up"),Muzhi.router.navigate(t,{trigger:!0})})}},Muzhi.Good=Backbone.Model.extend({defaults:{lazyRender:!1},stateMap:function(e){var t={"-1":["sell-out",!0],3:["obligation",!0],4:["success",!0],5:["close",!1],0:["to-begin",!1],1:["J-join",!0],2:["buy",!0],6:["sell-out",!1],7:["chance",!1]};return t[e]},toFixed:function(e,t){var n=Math.pow(10,t||0),r=String(Math.round(e*n)/n),i=r.split(".")[1],s=0;i?s=i.length:t!=s&&(r+=".");for(var o=0;o<t-s;o++)r+="0";return r},calculateTop:function(){var e=this.get("mzCorePart"),t=e.nowPrice||e.maxPrice,n=e.maxPrice,r=e.minPrice,i,s;return r==t?(i=105,s=82):n==t?(i=0,s=0):(i=Math.min(82,17+65*(n-t)/(n-r)),s=Math.min(66,18+48*(n-t)/(n-r))),[i,s]},getDetailUrl:function(e){var t=Muzhi.uriSysType;return"http://a."+t+".taobao.com/i"+e+".htm?"+$("#J_moreParams").val()},getItemInfo:function(){var e=this.get("mzBasePart"),t=this.get("mzClickPart"),n=this.get("mzCorePart"),r=this.get("mzInfoPart"),i=this.calculateTop();return{title:e.title,pic:e.pic+"_220x220.jpg",link:this.getDetailUrl(e.itemId),desc:r.desc,btnTxt:t.showName,maxPrice:n.maxPrice,minPrice:n.minPrice,currentPrice:n.nowPrice||n.maxPrice,numOfJoiners:n.numOfJoiners?n.numOfJoiners:!1,btnClass:this.stateMap(e.status),startTime:r.startTime?r.startTime:!1,region:i,detailUrl:e.status==2?"http://a.m.taobao.com/i"+e.itemId+".htm":e.status==3?"http://tm.m.taobao.com/list.htm?statusId=0":"#",allowRefresh:[3,4,1,2].indexOf(parseInt(e.status))!=-1&&n.nowPrice!=n.minPrice||parseInt(e.status)==7}}}),Muzhi.goodList=Backbone.Collection.extend({model:Muzhi.Good,url:function(){},parse:function(){}}),Muzhi.goodItemView=Backbone.View.extend({tagName:"li",className:"list-item",events:{"click .J-refresh":"refreshPrice","click .J-join":"join","click .hd h3 a":"jumpLink","click .pic a":"jumpLink","tap .dynamic":"refreshPrice"},initialize:function(){this.model.on("joinNow",this.render,this)},jumpLink:function(e){e.preventDefault();var t=this.model,n=e.currentTarget;window.localStorage&&localStorage.setItem("MZReturnToList",t.get("mzBasePart").itemId),window.location.href=$(n).attr("href")},join:function(e){e.preventDefault();var t=this.model,n=t.get("mzBasePart").itemId,r='<div class="join-tip"><em class="cz"></em><b>斗价成功</b>您可以立即购买,也可以继续等待</div>',i={api:"mtop.mz.doJoinMz",data:{itemId:n}};Muzhi.mtopH5.getApi(i.api,"1.0",i.data,{},function(e){if(!Muzhi.Util._checkLogin(e,n,!0))return;if(e.data.success=="false"){notification.flash(e.data.errorMsg);return}var i=$("#J-myNum");notification.flash(r).show(),t.set(e.data.defaultData),i.text(parseInt(i.text())+1),t.trigger("joinNow")})},refreshPrice:function(e){e.preventDefault();var t=this,n=this.model,r={api:"mtop.mz.getMzItemInfo",data:{itemId:n.get("mzBasePart").itemId}};Muzhi.mtopH5.getApi(r.api,"1.0",r.data,{},function(e){t.refreshRender(e.data.defaultData)})},refreshRender:function(e){var t=this.$el.find(".current-pos"),n=this.$el.find(".dynamic"),r=this.$el.find(".desc"),i=e.mzCorePart.maxPrice,s=e.mzCorePart.nowPrice,o=e.mzCorePart.minPrice,u,a;o==s?(u=105,a=82):i==s?(u=0,a=0):(u=Math.min(82,17+65*(i-s)/(i-o)),a=Math.min(66,18+48*(i-s)/(i-o))),n.find(".current-price").html("&yen;"+e.mzCorePart.nowPrice),n.find("em").text(e.mzCorePart.numOfJoiners+"人斗价"),r.text(e.mzInfoPart.desc),t.animate({top:u},500),n.animate({top:a},500)},render:function(){var e=this.model.getItemInfo();return this.$el.html(_.template($("#J-itemTemplate").html(),e))}}),Muzhi.goodlistView=Backbone.View.extend({el:"#J-content",initialize:function(){},addItem:function(e){var t=new Muzhi.goodItemView({model:e});return t.render()},render:function(){var e=this;$("#J-list").html(""),this.collection.each(function(t){$("#J-list").append(e.addItem(t))})}}),Muzhi.Goods=new Muzhi.goodList,Muzhi.Router=Backbone.Router.extend({routes:{"":"listDefault","!list/:id/p:pageNo":"list","!page/-p:pageNo":"listAll","!sold/p:pageNo":"sold","!my/p:pageNo":"my"},initialize:function(){var e=this,t="",n=$("li","#J-slider").length;for(var r=0;r<n;r++)r==0?t+='<em class="on"></em>':t+="<em></em>";$("#J-position").html(t);var i=new Swipe($("#J-slider")[0],{callback:function(e,t){var n=$("em","#J-position");n.removeClass("on"),n.eq(t).addClass("on")}});Muzhi.Util.catShow();var s=$("a","#J-tab");s.on("click",function(t){t.preventDefault();var n="cur",r=$(this).attr("href");s.removeClass(n),$(this).addClass(n),e.navigate(r,{trigger:!0})})},_listRender:function(e){if(!Muzhi.Util._checkLogin(e))return;if(e.data.success=="false"){notification.flash(e.data.errorMsg).show();return}var t=e.data.defaultData;if(!t){$("#J-list").html('<li class="tip-no-sold"><p class="txt">暂无宝贝，敬请期待！</p></li>'),$("#J-pageNav").html("");return}var n=$("#J-soldNum");e.api.indexOf("getMzBarelyList")!=-1?t.mzExtPart?n.text(t.mzExtPart.totalCount).show():n.text("").hide():e.api.indexOf("getMzList")!=-1&&n.html()==""&&(t.mzExtPart&&t.mzExtPart.numOfBarelySold&&t.mzExtPart.numOfBarelySold!="0"?n.text(t.mzExtPart.numOfBarelySold).show():n.text(0).hide()),Muzhi.Goods.reset(t.mzPartList),(new Muzhi.goodlistView({collection:Muzhi.Goods})).render();var r=new PageNav({id:"#J-pageNav",pageCount:Math.ceil(t.mzExtPart.totalCount/12),objId:"p"}),i=Muzhi.Util.scrollToItem(Muzhi.Goods);i&&(setTimeout(function(){window.scrollTo(0,i)},20),localStorage.setItem("MZReturnToList",0))},_queryList:function(e,t){var n=this,r=$("#J-sliderWrap");n._showNav(),e==0&&t==1?r.show():r.hide(),$("#J-catSel").addClass("none"),$("#J-filterLink").find(".arr").addClass("up"),Muzhi.menuList?Muzhi.Util.setCurrentMenu(e):Muzhi.Util.getMenu(),$("#J-list").html('<div class="loading"><span></span></div>'),$("#J-pageNav").html(""),$("#J-filterLink").addClass("cur");var i=$("#J_isTmall").val()=="true"?1:0,s={api:"mtop.mz.getMzList",data:{b2c:i,cc:e||0,pre:"0",page:t||1,pagesize:"12",ext:"1"}};Muzhi.mtopH5.getApi(s.api,"1.0",s.data,{},function(e){n._listRender(e),t!=1&&window.scrollTo(0,50)})},list:function(e,t){this._queryList(e,t)},listDefault:function(){this._queryList(0,1)},listAll:function(e){this._queryList(0,e)},sold:function(e){var t=this;t._hideNav(),$("#J-list").html('<div class="loading"><span></span></div>'),$("#J-pageNav").html(""),$("#J-soldOut").addClass("cur");var n=$("#J_isTmall").val()=="true"?1:0,r={api:"mtop.mz.getMzBarelyList",data:{b2c:n,page:e||1,pagesize:"12"}};Muzhi.mtopH5.getApi(r.api,"1.0",r.data,{},function(e){if(!e.data.defaultData){$("#J-list").html('<li class="tip-no-sold"><p class="txt">暂无即将售罄宝贝，返回宝贝页面</p><p>页面虽不曾留下痕迹，但我知你已飞过</p></li>'),$("#J-soldNum").hide();return}t._listRender(e)})},my:function(e){var t=this;t._hideNav(),$("#J-list").html('<div class="loading"><span></span></div>'),$("#J-pageNav").html(""),$("#J-My").addClass("cur");var n={api:"mtop.mz.getMyMzList",data:{page:e||1,pagesize:"12"}};Muzhi.mtopH5.getApi(n.api,"1.0",n.data,{},function(e){if(!Muzhi.Util._checkLogin(e))return;if(!e.data.defaultData){$("#J-list").html('<li class="tip-no-dj"><div class="icon"></div><p class="txt">还未参与斗价，快去斗个宝贝吧！</p><p>给你一张画布，绘一个缤纷世界</p></li>');return}var n=$("#J-myNum"),r=e.data.defaultData;r.mzExtPart?n.text(r.mzExtPart.totalCount).show():n.text(0).hide(),t._listRender(e)})},_hideNav:function(){$("#J-filterLink").find("small").hide(),$("#J-filterLink").find(".arr").hide(),$("#J-catSel").addClass("none"),$("#J-sliderWrap").hide()},_showNav:function(){$("#J-filterLink").find("small").show(),$("#J-filterLink").find(".arr").show(),$("#J-sliderWrap").show()}});